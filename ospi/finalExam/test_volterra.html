    <pre>
<span class="tuareg-font-lock-governing">let</span> <span class="function-name">test_circuit_volterra</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">()</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">c </span><span class="tuareg-font-lock-operator">=</span> new_circuit <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-governing">in</span>
  
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">src1 </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">{</span>
    <span class="type">I</span>.id  <span class="tuareg-font-lock-operator">=</span> 50<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.pos <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 1<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.neg <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 0<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.src <span class="tuareg-font-lock-operator">=</span> <span class="type">Source</span>.<span class="type">AC</span>.vac <span class="tuareg-font-lock-operator">~</span><span class="variable-name">freq</span><span class="tuareg-font-lock-operator">:</span><span class="type">w1 </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">mag</span><span class="tuareg-font-lock-operator">:</span><span class="type">a1 </span><span class="tuareg-font-lock-operator">();</span>
  <span class="tuareg-font-lock-operator">}</span>
  <span class="tuareg-font-lock-governing">and</span> <span class="variable-name">src2 </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">{</span>
    <span class="type">I</span>.id  <span class="tuareg-font-lock-operator">=</span> 60<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.pos <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 1<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.neg <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 0<span class="tuareg-font-lock-operator">;</span>
    <span class="type">I</span>.src <span class="tuareg-font-lock-operator">=</span> <span class="type">Source</span>.<span class="type">AC</span>.vac <span class="tuareg-font-lock-operator">~</span><span class="variable-name">freq</span><span class="tuareg-font-lock-operator">:</span><span class="type">w2 </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">mag</span><span class="tuareg-font-lock-operator">:</span><span class="type">a2 </span><span class="tuareg-font-lock-operator">();</span>
  <span class="tuareg-font-lock-operator">}</span>
  <span class="tuareg-font-lock-governing">and</span> <span class="variable-name">conductance </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">{</span>
    <span class="type">C</span>.g1_fn <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>io <span class="tuareg-font-lock-operator">/.</span> vt<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">*.</span> <span class="tuareg-font-lock-operator">(</span>exp <span class="tuareg-font-lock-operator">(</span>x <span class="tuareg-font-lock-operator">/.</span> vt<span class="tuareg-font-lock-operator">)));</span>
    <span class="type">C</span>.g2_fn <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>0.5 <span class="tuareg-font-lock-operator">*.</span> io <span class="tuareg-font-lock-operator">/.</span> <span class="tuareg-font-lock-operator">(</span>vt <span class="tuareg-font-lock-operator">**</span> 2.<span class="tuareg-font-lock-operator">))</span> <span class="tuareg-font-lock-operator">*.</span> <span class="tuareg-font-lock-operator">(</span>exp <span class="tuareg-font-lock-operator">(</span>x <span class="tuareg-font-lock-operator">/.</span> vt<span class="tuareg-font-lock-operator">)));</span>
    <span class="type">C</span>.g3_fn <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">((</span>1. <span class="tuareg-font-lock-operator">/.</span> 6.<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">*.</span> io <span class="tuareg-font-lock-operator">/.</span> <span class="tuareg-font-lock-operator">(</span>vt <span class="tuareg-font-lock-operator">**</span> 3.<span class="tuareg-font-lock-operator">))</span> <span class="tuareg-font-lock-operator">*.</span> <span class="tuareg-font-lock-operator">(</span>exp <span class="tuareg-font-lock-operator">(</span>x <span class="tuareg-font-lock-operator">/.</span> vt<span class="tuareg-font-lock-operator">)));</span>
    <span class="type">C</span>.pos   <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 1<span class="tuareg-font-lock-operator">;</span>
    <span class="type">C</span>.neg   <span class="tuareg-font-lock-operator">=</span> c<span class="tuareg-font-lock-operator">#</span>index 0<span class="tuareg-font-lock-operator">;</span>
  <span class="tuareg-font-lock-operator">}</span>
  <span class="tuareg-font-lock-governing">in</span>
  c<span class="tuareg-font-lock-operator">#</span>res 1 0 <span class="tuareg-font-lock-operator">~</span><span class="variable-name">r</span><span class="tuareg-font-lock-operator">:</span><span class="type">rs</span><span class="tuareg-font-lock-operator">;</span>
  c<span class="tuareg-font-lock-operator">#</span>cap 1 0 <span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="type">cpi</span><span class="tuareg-font-lock-operator">;</span>
  c<span class="tuareg-font-lock-operator">#</span>cccs 2 0 <span class="tuareg-font-lock-operator">~</span><span class="variable-name">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">70 </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">ref1</span><span class="tuareg-font-lock-operator">:</span><span class="type">1 </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">ref2</span><span class="tuareg-font-lock-operator">:</span><span class="type">2 </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">gain</span><span class="tuareg-font-lock-operator">:</span><span class="type">beta</span><span class="tuareg-font-lock-operator">;</span>
  c<span class="tuareg-font-lock-operator">#</span>res 2 0 <span class="tuareg-font-lock-operator">~</span><span class="variable-name">r</span><span class="tuareg-font-lock-operator">:</span><span class="type">rload</span><span class="tuareg-font-lock-operator">;</span>
  c<span class="tuareg-font-lock-operator">#</span>volterra <span class="string">"V"</span> <span class="tuareg-font-lock-operator">~</span>src1 <span class="tuareg-font-lock-operator">~</span>src2 <span class="tuareg-font-lock-operator">~</span>conductance<span class="tuareg-font-lock-operator">;</span>
  printf <span class="string">"v(2)=%g\n%!"</span> <span class="tuareg-font-lock-operator">(</span>c<span class="tuareg-font-lock-operator">#</span>vdc <span class="string">"DC"</span> 2<span class="tuareg-font-lock-operator">)</span></pre>
